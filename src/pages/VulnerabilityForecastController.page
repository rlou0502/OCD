<apex:page controller="VulnerabilityForecastControllerPaged" sidebar="false">
<apex:pageMessages />
    <script>
function setFocusOnLoad() {} 
</script>
    <style type="text/CSS">
        .oppRow {
            background: #7DC2D8;
        }
        .oppRow2 {
            background: #E7ECFA;
        }
        .itemRow {
        background: #F4F4F4;
        }
        
        .itemRow td{
            
            border-bottom: 0px white solid;
            height:10px;
        }
        
        .itemRow:hover {
            background: #FFFF99;
        }
        .oppRow2:hover {
            background: #FFFF99;
        }
        #listTable td {
    
        }
        
        #headerRow {
            background: #C4CFF3;
        }
        #productheaderRow {
            background: #DADADA
             
            
           
        }
        #productheaderRow td {
            font-weight: bold;
            //border-bottom: 1px black solid;            
            margin-left:120px;
            
            //font-size:112%;        
        }
        
        #headerRow td {
            //color: white;
            font-weight: bold;
            font-size:112%;
            //border-bottom: 1px black solid;
            
        }
        .title {
            font-weight: bold;
            font-size:200%;
            align:left;
        }
        .stage {
            width: 120px;
        }
        .quantity {
            width: 30px;

        }
        .account {
            width: 80px;
            margin-top: 1px;
        }
        .commitment {
            width: 125px;
        }
        .currentsplit {
            width: 70px;
        }
        .dateFormat {
        width: 40px;
       display: none;
        }        
        .unitPrice {
            width: 80px;
        }
    </style>

    <apex:form >
        <apex:pageBlock >
        
                
            <apex:pageBlockButtons >

                
                <apex:commandButton action="{!save}" id="saveButton" value="Save All Changes"/>
                <apex:commandButton action="{!cancel}" immediate="true" value="Cancel"/>
                
                
                
            </apex:pageBlockButtons>
            <table id="adsf" cellspacing="2" width="1450px">
            <tr>
            <td>
            <apex:outputtext StyleClass="title" value="Vulnerability Forecast " />
            </td>
            </tr>
            <tr>
            <td>
            The Vulnerability Forecast table will display all of the Vulnerability records to which you have access and conditionally, 
            </td>
            <td>
            <apex:outputLabel > </apex:outputLabel>
    <apex:commandLink action="{!PreviousPage}" value="Previous Page"/>
                <apex:outputLabel >Current Page: </apex:outputLabel>
                <apex:outputText >{!pageNumber}  of {!maxPageNumber} </apex:outputText>
                <apex:outputLabel > </apex:outputLabel>
        <apex:commandLink action="{!NextPage}" value="Next Page"/>
            </td>
            </tr>
            <tr>
            <td>
            if the Vulnerability Status = Lost or Partially Lost, the Date Lost must be within the past year, and if the Vulnerability Status = Not Vulnerable, the Date Not Vulnerable must be within the past year.
            
            </td>
            <td>
            <apex:outputLabel >Number of records per page </apex:outputLabel> 
        <apex:outputLabel > </apex:outputLabel>    
            <apex:inputText styleclass="quantity" value="{!pageSize}"/>
                <apex:commandButton action="{!applyRecordsPerPage}" id="saveButton2" value="Apply"/>
                <apex:outputLabel > </apex:outputLabel>
            </td>
            <td>
            </td>
            </tr>
            <tr>
            <td>
            Please note that the Account Territory filter will only include those Territories that have Accounts with Vulnerability records.            
            </td>
            </tr>
            </table>
            
            <table id="mastertable" width="1450px" border="1">
            <tr>
            <td>
            <table id="listTable2" cellspacing="1" width="350px">
        <tr>
        <td>
            <apex:outputlabel >Primary Sort </apex:outputlabel>
            <apex:selectList size="1" value="{!sortSelection}">
              <apex:selectOptions value="{!sortOptions}"/>
              <apex:actionSupport event="onchange" action="{!primarysortSelected}" status="StatusChange" rerender="ss" />
             </apex:selectList>
             <apex:actionStatus id="StatusChange">
                      <apex:facet name="start">
                          <apex:image height="12" width="12" value="{!$Resource.waiting}"/>
                      </apex:facet>   
                </apex:actionStatus>
                <apex:selectRadio value="{!primaryDirection}">
            <apex:selectOptions value="{!sortDiections}"/>
            </apex:selectRadio>
            </td>
            </tr>
            <tr>
            <td>
            <apex:outputlabel >Secondary Sort </apex:outputlabel>
             <apex:selectList id="ss" size="1" value="{!sortSelection2}">
              <apex:selectOptions value="{!sortOptions2}"/>
             </apex:selectList>
             <apex:selectRadio value="{!secondaryDirection}">
            <apex:selectOptions value="{!sortDiections}"/>
            </apex:selectRadio>
            <apex:commandButton action="{!applySort}" id="sortButton" value="Apply Sorts"/>
    
        </td>
        </tr>
        </table>
            </td>
            <td valign="top">
            
                <table width="1310">
                <tr>
                     <apex:outputlabel >Status: </apex:outputlabel>
                     <td rowspan="2">
                     <apex:inputfield style="" value="{!theVulnerabilityFilter.Shadow_Vulnerability_Status_for_Grid_Pag__c}"/>
                    </td>
                        
                     <td>                
                    <apex:outputText styleClass="account" value="BP Cycle "/>
                     <apex:selectList size="1" value="{!theVulnerabilityFilter.BP_Cycle__c}">
                      <apex:selectOptions value="{!BY_CycleOptions}"/>
                     </apex:selectList>
                    </td> 
                    <td>
                    <apex:outputText styleClass="account" value=" Account Territory "/>
                       <apex:selectList size="1" value="{!theAccountFilter}">
                          <apex:selectOptions value="{!territoryOptions}"/>
                            </apex:selectList>
                    </td>
                    <td>
                    <apex:outputText value="Account Name "/>
                    <apex:inputtext value="{!TheAccountNameFilter}"/>
                        <apex:outputText value=" "/>
                    </td>
                    <td>
    
    
        
        
    </td>
    </tr>
    <tr>
    <td>
    <apex:outputText value="Date"/>
        <apex:selectList size="1" value="{!theVulnerabilityDateFilter}">
        <apex:selectOptions value="{!DateFilterOptions}"/>
        <apex:actionSupport event="onchange" rerender="panelID" action="{!DateFieldSelected}"/>
        </apex:selectList>
        </td>
        <td>
        <apex:outputpanel id="panelID">
        <apex:outputText value="From"/>
        <apex:inputText value="{!startDateRange}" size="10" id="sdr"    onfocus="DatePicker.pickDate(false, this , false);" />
        <apex:outputText value="To"/>
        <apex:inputText value="{!endDateRange}" size="10" id="edr"    onfocus="DatePicker.pickDate(false, this , false);" />
        </apex:outputpanel>
        </td>
    </tr>
    <tr>
    
 
    <td>
    
    
    </td> 
    </tr>
    <tr>
    <td>
    </td>
    <td>
    </td>
    
    <td align="left">
    <apex:commandButton action="{!applyStatusFilter}" id="filterButton5" value="Apply Filters"/>
    </td>
    </tr>
 </table>
            </td>
            </tr>
            </table>

            <table id="listTable" cellspacing="5">
                <tr id="headerRow" style="text-align:left;">
                    
                    <td>Account Name</td>
                    <td>Account City</td>
                    <td>Line Of Business</td>
                    <td>Vulnerability Name</td>
                    <td>Current Customer Protection Plan</td>
                    <td>Estimated Last Product Order Date</td>                   
                    <td>Vulnerability Status</td>
                    <td>Include/Exclude</td>
                    <td>BP Cycle</td>
                    <td>Annual Revenue at Risk</td>
                    <td>Revenue Impact - Year of Loss</td>
                    <td>Annual Volume at Risk</td>
                    <td>Volume Impact - Year of Loss</td>
                    <td>Date Lost</td>
                    <td>Account Territory</td>
                </tr>
                
                <apex:repeat value="{!keys}" var="key">
                    
                    <tr class="oppRow2">
                        
                        <td style="{!if(sOpp[key],'background-color:#FF4747', '')}"><apex:outputLink value="/{!s2opp[key].account_name__r.id}">{!s2opp[key].account_name__r.name}</apex:outputLink></td>
                        <td><apex:outputField styleClass="account" value="{!s2opp[key].account_name__r.BillingCity}"/></td>
                        <td nowrap="false"><apex:outputField styleClass="currentsplit" value="{!s2opp[key].Line_Of_Business__c}"/></td>
                        <td><apex:outputLink value="/{!s2opp[key].id}">{!s2opp[key].name}</apex:outputLink></td>
                        <td><apex:outputField styleClass="account" value="{!s2opp[key].Current_Customer_Protection_Plan__c}"/></td>
                        <td><apex:inputfield value="{!s2opp[key].Estimated_Last_Product_Order_Date__c}"/></td>
                        <td><apex:inputfield value="{!s2opp[key].Vulnerability_Status__c}"/></td>
                        <td><apex:inputfield value="{!s2opp[key].include_exclude__c}"/></td>
                        <td><apex:inputfield value="{!s2opp[key].BP_Cycle__c}"/></td>
                        <td><apex:inputfield styleClass="currentsplit" value="{!s2opp[key].Annual_Revenue_at_Risk__c}"/></td>
                        <td><apex:inputfield styleClass="currentsplit" value="{!s2opp[key].Revenue_Impact_Year_of_Loss__c}"/></td>
                        <td><apex:inputfield styleClass="currentsplit" value="{!s2opp[key].Annual_Volume_at_Risk__c}"/></td>
                        <td><apex:inputfield styleClass="currentsplit" value="{!s2opp[key].Volume_Impact_Year_of_Loss__c}"/></td>
                        <td><apex:inputfield value="{!s2opp[key].Date_Lost__c}"/></td>
                        <td><apex:outputField styleClass="account" value="{!s2opp[key].account_name__r.Territory__c}"/></td>                         
                    </tr>
                    
                    

                    
                  
                </apex:repeat>
                
            </table>
        </apex:pageBlock>
    </apex:form>

</apex:page>